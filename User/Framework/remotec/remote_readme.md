##### *by Glucose_carbide*
# 声明
底盘遥控器只是在底盘调试时使用，装了云台之后是接收从云台传来的数据，而不是在底盘的dbus口上插接收机跑
# 遥控器`FS-i6x`使用说明
## 简要介绍
- FSi6x(以下简称FS)是一款比较好用的遥控器，相较大疆，FS拥有更多的channel与更自由的配置，是遥控器的好选择
- FS开机时需要将所有开关都拨至最上面，并且将左摇杆拉至最下面才能开机，否则会报警
- FS有多个可编辑按键，分别为:
  - 两个摇杆，对应代码中的`rc_(left/right)_(horizontal/vertical)`
  - 四个开关，对应代码中的`rc_switch_(A/B/C/D)`
    - 除了第三个开关有三档，其余都是两档
  - 两个旋钮，对应代码中的`rc_knob_(left/right)`
- FS可自由选择发送数据的格式(pwm/ppm)与协议(ibus/sbus)，其中，我们更倾向于选择sbus作为数据传输的方式，这样可以通过直接更换接收机与选择不同的解析代码就能在大疆与FS间实现切换，不用使用全新协议
- 我们可以自由配置所有可编辑按键对应的通道(在数据帧中的位置)，但这也导致接收端需要和发送端商量好各个通道对应的按键是什么。该代码中，默认是:
 
  | 按键名称      | 变量名           | 通道(FS16_CHANNEL_) |
  |---------------|------------------|---------------------|
  | 左摇杆水平    | `rc_left_horizontal `| 4                 |
  | 左摇杆竖直    | `rc_left_vertical   `| 3                 |
  | 右摇杆水平    | `rc_right_horizontal`| 1                 |
  | 右摇杆竖直    | `rc_right_vertical  `| 2                 |
  | 左旋钮        | `rc_knob_left  `     | 5                 |
  | 右旋钮        | `rc_knob_right `     | 6                 |
  | 开关A         |` rc_switch_A  `      | 7                 |
  | 开关B         |` rc_switch_B  `      | 8                 |
  | 开关C         |` rc_switch_C  `      | 9                 |
  | 开关D         |` rc_switch_D  `      | 10                |
  （当然也可以通过修改宏定义来自定义你的配置，但我不建议这样，最好和全队协商后达成一致意见！）
- **FS在重置后或首次使用时需要进行一系列配置才能使其发送的数据能被该代码正确解析!**(这一步很重要!)(下文会简述配置方法)
- FS遥控器搭配ia10b接收机时，一个数据帧长度为25，其中byte1(`rc_data[0]`)恒定为0x0F，byte25(`rc_data[24]`)恒定为0，所以可以通过`if (rc_data[0] != 0x0F || rc_data[24] != 0x00) return;`来确保程序接收到错误数据包时不解算以防止疯车
- **搭配ia10b接收机时，即使遥控器关控，接收机也会持续往C板发送数据，但数据帧的第byte24(`rc_data[23]`)有表示遥控器是否断连(断连则为1)**
## 代码说明
- 在代码中，我用了一个类来存储遥控器的数据，既方便又简洁，且安全性较高
- 将switch3(第三个开关)设置为安全开关，当该开关在最上面(开机时强制要求的档位)时，则主动将rc_online设置为false，从而能快速掐断底盘电源
  - 由此可见，这个online既表示了遥控器是否真正在线，也表示一个由switch3所控制的，用户希望其是否在线
- 综上
  - rc_online变为false的方法为:
    - 直接关机(半秒左右)
    - 将第三个开关拨至最上(立即)
  - rc_online变为true的方法为:
    - 开机
    - 将第三个开关切换至中或下档
## 配置说明
#### **保存退出需要长按cancel，否则在某些配置中是不保存并退出，有些是:wq**
#### **EDITABLE表示可自定义编辑，但需要改源文件中的宏定义，根据自己的配置**
- 开机后，先对频，接收机红灯常量表示已连接
- 长按`OK`，进入设置
- 选择`系统`
  - 选择`接收机设置`
    - 选择`输出模式`
      - 调整为`ppm`与`sbus`模式
  - 选择`摇杆模式`
    - 调整为`模式2`(EDITABLE)
  - 选择`辅助开关设置`
    - 将所有开关设为`开`，并将通道设为`10`
- 选择功能
  - 选择`辅助通道`
    - 配置通道`5`为`VrA`(EDITABLE)
    - 配置通道`6`为`VrB`(EDITABLE)
    - 配置通道`7`为`SwA`(EDITABLE)
    - 配置通道`8`为`SwB`(EDITABLE)
    - 配置通道`9`为`SwC`(EDITABLE)
    - 配置通道`10`为`SwD`(EDITABLE)

# 遥控器`DT7`使用说明
- DT7是一款大疆开发的遥控器，支持与robomaster软件连接后使用键鼠控制与发送数据。在日常调试时，我们会使用FS，但在进行比赛时，会切换为DT7遥控器。

# 程序食用指南
- 在程序中，两遥控器共用同一个class，但启用一者时会将对方没有的通道失活(类在初始化时会将所有通道设置为失能状态，若一个通道没有被更新，那么其就一直是失能的)
- 头文件中，我们可以通过修改第19行的宏定义，来选择哪个遥控器(只能启用一个!)